<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mp04 â€“ STA 9750 2024 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-824b22946342c3b062afb6f9f3c44d05.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 2024 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mp04</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-4-monte-carlo-informed-selection-of-cuny-retirement-plans" class="level3">
<h3 class="anchored" data-anchor-id="project-4-monte-carlo-informed-selection-of-cuny-retirement-plans"><strong>Project 4 : Monte Carlo-Informed Selection of CUNY Retirement Plans</strong></h3>
<p>by Maria Jerez</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxQREhUSEhMVFhUXGBsbGBgXGBcbGBgVGBoeHxocHhgbHCghGBslHhkXITEhJSkrLi4uGB8zODM4NyguLisBCgoKDg0OGxAQGy0lICY1LTUvLS81LS0tLS03Ny8vLS0tLS0yLTAtLS0tLS0vLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIALcBEwMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABAUCAwYBB//EAD0QAAICAQMCBQIEAwUIAgMAAAECAxEABBIhBTEGEyJBUTJhFCNxgUJSkRVicpKhM0NTgqKx0fAHwiSywf/EABoBAQADAQEBAAAAAAAAAAAAAAABAgMEBQb/xAAqEQACAgEEAgEDAwUAAAAAAAAAAQIRAxIhMVEEQRMi4fAyscEUYXGB0f/aAAwDAQACEQMRAD8A6/GMZ9EeOMYxgDGMYAxjGAMYxgDGMYAxjGAMYxgDGMYAxjGAMYxgDGMYAxjGAMYxgDGMYAxjGAMYxgDGMYAxjGAMYxgDGaW1K7tgtn/kQFn/AHVbIH3NDJum6RqJO4WBf71PJ/lU7F/Xc36ZlkzQh+pl4Y5S4RoxkvqXQPKj82JpZJE5YMxPmIPqUIKQNXqG1QSQB2JyFG4YBlIIIBBHYg9jkYs0cquJOTFLG9zLMJpQilmNKoJJPYACyczyj8ZsRpmG4KrEK7EkAKQa5H94Lx7ix75ectMWysVbSPej9SmmRnZYxtldCp3rsC8qDKN6M5Ujj083llpNYJCVoqyhSVJQ+l72m0ZlINHsfY5896ZrvL0ybY3j1W/c06SshKhdqqUUgAKu0f8ALdWTl74M1U00js7h1RAhbYilnJ3AFkA3bRfJs/mDnOXDkyakpG+SEKtHXYxjO05hjGMAYxjAGMo+o+Jo4NZDpHHqmWw1igSSFBH94qQPvWexeJI21zaFQSyx7ma+A3B2VXJog3+2Z/JG6v8AsW0SLvGYmQAgWLPYWLP7YeQDuQP1Iy9lTLGQ+o9Uig8vzWrzZFjTgm3bsOOw+54yU0gFWQL7WRzi0TTMsZ4xrk8AZysfi6Wa30mhlnhBI83eqBq7lFblhlZTUeSVFvg6vGYCUcXwT7Ei/wBPvmRcDuQP3+ctZU9xlT4b6sdVE8jKF2yyJxdUhq+ctEcMLBBHyDeRGSkrRLTToyxjGWIGMYwBjGMAYxjAGR2VS8gk3ECFniQOUWSSMMzKzL6rraQAaID8GskZq1ERYek7WBDI38rjsfuPYj3BI98zyxcoNJ0XxyUZJst26ksGgfUaXTXsQt5CAK28fUp2g+pTuugbo1eVLeJ4Op9PnWFm846ZmaCJ/wA9TR4U1ybocD3Fjmsy0fThqY5NPHp44dJqImWcxnbJFqRaMAvIcUEo0BQB5BrN/g/wJD06QyId7FAodgfMsm35DbdppKAUVt7m88Bpp7nrLdbFP/8AFHW9dMDDqkHlxxKUkY1MeaXerMWYMA1NtA9Hc5a6/Sfh5ig/2cltH/dbvJH/APcfYsOy51+QusdPE8RS9rcMjfyyLyp/T2I9wSPfNsGX4536M8uPXGjm8jdS0CaiMxSi1JB4JBtSGBsciiAc26eUsPUNrAlXX+V1NMPvz2PuKPvmzPb2kjy90zmYvCIilWWOXftN+XqEWWM8V2G0/fm+QMuej9PEEQT02SzPtFKXc21D2UXQHsAB7ZNzwmuT2yqxxTtEubapnuMhHq8A/wB9H+u4V/XtkxGBAIIIPYjsRllJPghprk9xjGWIGMYwDhOpdKXX9Q1kZNGPTRIjc2krHzFYH7H49ic0wdIOi1XTWc3JI04nf3eWVQe/uAeB+md+sYBJAAJ7muTXyffDIDVgGuRY7H7fGc/wLn397NflfHr7HyyX8KdNrDqiP7QEklbifOEgP5Pl++36a28V9st+n9LXU68LrYxI40MJcP7SE0xocbuTz7e2d00ClgxVSw7EgWP375kEF7qF9rrmv1yF4/f5/kl5T5MI436d02SemVNWI2Z+wg3tak+y0B+wGTOswRtrZElbTJB5EY0pnD+V5O0bvKKuFDX7nn4z6WdOm3btXb/LQr+nbEmnRgAyKQOwIBA/QHtkf0+3PRPzfyUnTdCz9N8gTCVmhdFlF024MEPPPAIF/bKjwp4o02n0iQahxBLACkkbghrUnkCvVffj5ztQK4Ga5dMjEMyKxHYlQSP3IzT42qcXxsU1p2mfLvG+rimfVkLp45IvLp3ZzqJTSkGIAgIoHvzxz75faLTxarqYkepANJDIhs1vD8NweSPvnaNApO4qt1V0Lr4v4+2exwqv0qo4rgAcfH6fbKLB9Vtlvl2pHy/zh+E2Mx8kdRYaoLdiEufqrkKT3y96D5A6kRoCvkfh7m8s3D5m70VXG+vj2v752YiUX6R6vq4HP6/OIolQUqhR8AAD/TJjgaadh5bRnjGM6DEYxjAGMYwBjGMAg9Y6ommj3v7kKoutzHsPt8k/AzidX1GfWkNHIyRCvdlVmHelQqzL7etj2uuaFz42kIKDYDvUqrWQVYEMwHNWwVe4PCntycotYzaZRCYytLxuBUha9NqQLBAPIq64HOcGfI3LT6OzDBab9nQeAuvNp9T5MhTy5AqkqqoA/aN6Bsk0UZjZ+gkn2+s58IfQb4HEUgfUFwvkjsoIq9xIHYk7QCQAxJHJH1vwnrneIQzsGniVQzf8RSPS4/WiD91PyM4skG1qR1Rkk9JeYzVqdQkaNJIyoiglmYgKoHcknsM5/wAYeI/I0ks2nPmvG6owiKsY2JF7xR2iiLFX6vbuOc0HiPSeW41Cj0vSy/Zu0cn/AGQ/Yp7LkPKnwz1OXX6V9ZPDHLPE8sPlq5Qfh5Au9ZEpqI5PC7iEFd+Zmhk4C3uG1XRjX5kMguN7Hc1wT/Mp9iM9Tws1rQ/9HB5WOnqRKzlPEczv9a/k+oKrA7XCkAub4Zb3cg2tKfckdWM4vzJvoPmOIyFAJ9o5BarubkEbuAAB6fbNfLk1FJFfGinJs3dQGo1I82QBm21RK7ztBCV6Qo+omyAbrjjN2k6pFCsZjBFufOtvTtPC0n8Dr/EeLAa7YgJlL1mLZvEi17m6r7UeQftlfp9KksUjSPsZg/lowJBkZvy0IUgKzbw3r5BbtnDFuLTidcopqmdtjAxnsHljGMZIPn/iXUn8a6azU6nS6fan4doSVjdiPXvcA+oNffsB/W4EgiOgT8TPNvd9siuu2UUSPMIPrABoV7i839W/H+ZIsUellgYDaJCwYekbtwqmG6zWVnSPCcsC6FSyN5EskklEgDzB2SxyB+3vnHUlJ0vyze04q/zYkS+OEVGlOmn8mOQxyS+jarBtvA3Wwsj298naDxMJJRFJBLCzRmSPzNvrRe/0sab7HKqbwxMenanSjZ5kszOvqO3a0itya4NA+2W2t6Q76vTTcbI4pUfn1W6gChXOXTy/t9yGofueDxTGdNBqtj7Z5FjVfTuBZioJ5qvT7fOQfD2pZH6iwR5CuqNIlFjwOBZA97/rldH4b1og0+kIgMUE6uJN7BnRXJHo20D6j7/+ck67w7qiuuSJkAnmWVCHZSw43xtQteB3Hf8AfK6pum1x+9E1FWr/ACya/iotFqq08iT6dNxjbYeGHDWGoqO5F9h85Dg6600OhkmE8TSTRgeWyqspZbsgE3EeeO/GedL8MzJJqKi08MWo05j2xsx8tgCBdqN93ZOZ6foWpMOhjkWJTpZ0J2uSGiRa3D0/VZ7fbvkXkfP5v/wn6FwTNT4vVTKyaeaSGFissq7NqlfqoFgXC+5H/bnNmq8VKJVhggl1DPCJlMZQKY2NXbMK9v6jK7+w9ZDHqNLB5DQzM5WR2YPEsv1AoFO8jmjf/jJnSPDjafWRyAgxR6NYASfWXVwbrtRA+cunkexVqBb9D6qmrhWaMEBrFMKZWU0QR8gjJ+U3hPpj6aAxybdxlkb0mxTtY9u+XObQbcVfJnKrdDGMZcqMYxgDGMYAxjGARuoaCOdDHKgdT7H5HYg+xHyMpNX4NillMsk2oYmrUuhXgUONl1X3zpMZnLHGW7RaM5R4ZD6b0qLTiokC+xPdiB7FjyR9uwyQ0jROs6Alo7tR3eM1vT9TQI/vKv3zZmmTUgNsp2agaVGagbAsqKW6NXXY/GJRjp0vgKUtVrkvfEWlk1middJP5bSKpjlF0VsGrHIDLYsdr/bOT/8Airoc2h1Gtgmie7jI1HqEco9XC3wT6iSQb5o1lt03qz6RWEmnnMLOpjKiMsrSNTLs37itnfwCfUwrgZP1viQONukKufeU8xx/IrjfIP5f4SPVR4PivDLXpW56ayx06mZuNN08yGGICXUOZCifVI/uxs0i/J4Fk+5o08asSGfaCF2qiCo409kUe/tZPeuwFAYNUSvIxZjRZ3PLvtF8/wD8AoDsAM+d6zrGsZnMylPNjVkQl08tWKlChVlLN39RsHn24HYow8ZJy3kc7cs+y2R9Myv12jepDDsDShRJuX6gp42t/u37DdR4A4sAjhugeLZYCV1RkZeNu4Bye1gSWCD3IDXdVY759A02sEtGBWmBQPce0gI1hTyQTe1uACfSc6FmxZoOzF48mOWxzvTOj1Jeo08jCiAU8gkUOPqatpbdx7Csn9H6IUYSSkFhZVAbVS1kmyOTZNDsLPegRaPrkU05MZ7VKrRkn7bwL/bJAN8jJx+PjTtbieabVPYYxjOkwGMYwBjKl+psrsApcFwoFqAo3CP4s2+8nngIa5FHSniAMV2qKYLxuG7cwjr3+m5o+a+fkZn8kS2ll5jK2TqZ8tWWPlmUcn00z01MOTQsjjnIw6pI2mknUAcFoxtNlSoKjaCSzWQOPftfFzrQ0su8ZSjrwLClBBAobl3EkJXY1R82IX8k+1HN3UuotEquRtFsGBAJOxS52m6rajizXcdsfIhpZaYyrXqpWNWkCkmQoSvCDmru2JF0t/J5oWc1RdbJ23GaNc7gOSY1PHyGlAAvna32t8kRpZc4yun6sEYKUYEqWG6h6VvcTV0BS/PMij3zWeqloHlVCu0M1sPSRGxDV2JsKaJA7g/bGtDSy1xlVoeps8jJQYKB9Nbr3MhLergFo3PbtXvYzUOt2/YBFsPzypZhsbt2oOTXFc2cj5ENLLrGU8PXA/G0jmma+x9fKhl9VeWxNgVRyy0LMY0L/UUUt/ioXx+uWUk+CHFrk3YxjLEDGMYAxjGAMYxgDJvhiJXV5H7SMWH+BfSlfYgF/wDnOV86FlZQ20kEBhztJHBr7d8r9H1LUR7YHZUYCl2RjY4UfwFiew/hPI/Tk83kt0bYasvpJ/z41HaPdJz8kFEB/UGX91GVXWgU36lKD7wHT+GXcQq/4XsgBvfgG6FV/wCPeKZmYtKGq6UF0C8Cgg9SdzVbgSe90LfrAVm04Rw6yDzjXI2x1t5/xsh/5DmUHF01yzSSlw+EeaqEOjIezKVP6EVnyB5dSrmKVneSL8uibtVPpAs3tsggAdiO1jPseVut6OjzR6lfTPH9L8/tddyLsH29wQSDfysDyK48orgyqDp8Hy+V/MRgBuU2Nw7Di7v7Ahr9hznef/GLpMjxIpuN4pZS1MvJkPoFgqfTY4sNI59+OY6l0LqHmPNIkDWzSMyuFj9yfTQNcn29s+seGPDsGj/PKRxzzVu2+lFL0REgJ7Aih7nmqFAeVKEofqVHfGUZcEnwz4kTXq+2Nl27dwaipLbuAffgc8e4z0dM0MzMEEYcMQ3kuY23LW6/LIJqxd/OVbdV/BauPQwadTG4QiiQ1ux3uTzYCg/5e9ZJ8P8AhQafUzalmssz+WB/CjmyT8n2/T9eKKTXBZpPk0dU0H4eSNVldg+61fadqoByGChvqZRyT9WYZu6xJv1TfESKn6M/rb/p8rNOe342p405M8vPWtpDGMZ0GRrigVboAWSf3Jsn+pJ/c5kIl70L/Qe3bPDKu4JuG4gkLYsqKBNd6sjn7jM8jYHhQdqFf+O2eKgAoAAfp75lmEkoWtxAsgD7sewwAIl77R/Qe3bMioPcZjJMq7QxA3Hat+7UTQ+9An9szxsDDyl4G0UO3A4/T4zLYPgf+8/989zCWZVrcQLIUX7sew/XGwPDAu4sRZK7ee22yarsLvn5ofAzPaKqhXavav0z3GKBiqAcgAE9+O+FiUdgB+gH/vuf65ljANUmnVl2lRtqq7cfHHt3/rm3NOn1SSfQ6twDwfY2Aa+Dtb+hzdhV6JGMYySBjGMAYxjAGM1S6hVIBuzdABmYgVZ2qCaFjn7jIc3XIEFs5UfJSQAX8nbQyrlFcsnS+ixzXPArjawsf6gjsQRyCO4I5GbMZLVkFevSVDbt8u753m/9M26PpscTu6htz1uLOzXXwGJC9+aq/fJeU3Ueu7W8qBDLITRr6V55s+9fsLFFgTmbWOG9Gic57FzjOJ1XUpg7efJIpTbccRFWw7Fl5U9iENk2BfN50nh3VPLp0eT6jYv5AYgH9wO/Y9xwciGZTdImeJwVsmaiLzCkX/EkVCPlLtx/kV8u/GHRG1sKxowVhIrWewHIJ+5prr7ZB6NHv1S/EUbMfs7nan/T5uWGk8RRy6x9IoNxoSW9i6kAqB9r7/IPxnnedK8ldHZ4sahfZE8QJ+B0fm6dR5kKRxq7AMwiDAH/AL/+1ll4b18mo06SyxiNnJIUX9F+k888j/z75YTRqw2sAQfY0Qf2PfIfXtSYtPK6/UEIX/G3pT/qK5xpW6Olujl9PLv3y/8AEkdx91uk/wChUzdmEMQRVQdlAA/QChmefQxjpSR40nbsYxjLEHNajRTnVfiggpJFQCzvOnoq/Hat0jSd7Plr9s3dX0s7SSNG0oo6cIFeloyETnb2Y+Wfe6oEc5t1PiBVdkCP6J1if8tze6PfabR6jyOPjnsQc3HxBp/T6z6gDwj+kFtlv6fy/UCvqrlW+DnPUN1Zr9XRVzaedW2n8Q0KmUJ5bnzS35ZhJctuZf8Aaj1Ejtu4zCPTalnjMwlMqyRm1I/DhBENx23/AMTd7bu38OXms6zFE5jcsGAVmpHKqrkqpZgpVRankn2zU3X4RYuQkM60sUrEmMkSUApLBSKLDiyBfIw4w7Ccuil6ZpNTcLTGVyskZkVl4V9kiu6sZGBW2WwlKAAQO+WesecSsqrIVMkLKy1tEYoSDvx2Niudw+9ZaXxBG0jIT6d8axuquUYSxoy3JW0Fi1AEi+PkW1XiBFICh7Eqo6mOUOA6sVKpt3NZWgQCO/xhaEuQ9TfBUCDVbFQmbaHO+T8wyOdgKts80MihtwKq22642kgbjpZ2kj8zz3ZZoSGFLF5Sou5igag2/eSOWBIo7cspeuKdnlUwZoxyHDDfN5bWpA2kEEUeQRyMx0/iOMnawYVHG5cK5jqVio9W0ULHcge/wajTDsm5dEbqGklE07xib1+RZRjzGGqUJbUr7f0NE7eTnmpklj0jm5R+cgjsgzeSZUWixJtjbVuN0Vvm8uZOpxKsjlvTG2xjTfXx6VAFubYLS3zx34yu1HWEkeGJV3B5CHDxSEoY9rAFSBsayjAt2FN98lxir3ITb9EJNNqi1IZljHnGLzHN2Fh8oSEksy+YJjRJO3g8Gsw0kGoATe2pKFgZFG5ZFbY3ZzKzMu/bYQgChXpsZ0R16CUQncHIJFo4VqAJAcjaxAN0D8/BzA9Uj7WxNuu0I5a4/q9IF/FfO5a7jJ0R7I1Po5zRaTUokaFZhEFhEgVgJK/P30VIIbcYCxU3V1lx0jS7JpmqUB1jKl2YiggBBskBwRz75lL4hhCblJsrKVBSUV5Jp94CEoFJF2P0vMpevwqSpLFgCaVHILKm8orbaZ9tnbd8H4OEoL2S3J+i0xlbD1yJlDEsvEXpZWDfnNtj4Is21ix8HLLNU0+DNpoYxjLEDGMYBzOm6hqE1Ejh4l/MMfqdgQi8oCtcg969y3x23dS1zaiSKKdNOd6uFMdkyTcIisOwUb2bivVGvPzq6t0/86RjpXmV9jAq6CiAFZaZgRwoN175HbQsDGYdLMjrJQMjRlVR1ZC1hybTfuA72ozzJwlrezO6Eo6eUdNoZd8aP/Min+oBzfmEEIRVRRSqAAPgAUP9M1azXxQgGWREvtuYC/0vv+2ejdLc4uXsVPiXWt/sUfy7ALMAS1HdtVaH8Wx7PcAccnijXWywI0EaJG60JXDAvu2g229QsKUVoG6HAHGXusg0mvoCVWYAj8t13bTRIIINjse3H75P03SYkIYLbCqLc1QrgfSprj0gZzTxSnK09johljCNVuUXSeh+YD5iARbty7gfN3HliHNMb4HmNTVuAADEnqkUAAAAACgB2AHYVnuM3x41BbGM8jm9yz8KRX50v80mwf4YhX/7mXJ2l6fpzJ+JjVN5DKXTs1t6rrhja1ffKzpEQ1HT/Ijk2SGPbIR9Ucz+qQFbBHLN8WDY+c2+H9Ken6MrOwqIyNa2fy7JH7kc196zw80m8jbPUxqoJFdqdDq/7UimPqgtlWjwieXzuHsS3v7kD7ZY+LJLEMX88m5v8MQ3X/n8r+uaeneLUl0k2rMbBYnIKL6mr07T/RhZ7Cj8Zp61Lv1R+I41Uf4pDuYf5Vi/rmnix1ZUUzyrGzRjGM9w8sYxjAK7+yV81pN7eqRZSvprekfl32uioXi/bIqeGIlcOrMGtrtYm3BpXlr1odtNI4BWjR5uhWibq8nnmIPGG8woItpMgi2WJr3crfN1tr0/VzmnpUzafp2lIKJuWLfIy+mMSAMzsLFmzRYkctZ9857g3x2a1KuSZreitNPKzOywyRRIyrs/M2tIXVrUkCnUWCOGb9t56GBRSWSNw0xDrsJrUPvdaZStbtpHFjaOe908/iZ0ikYvFflymFqIWZ43IUqC3qBWjQPPJHGbX6u8byK+ojUfiGVndRUKbCyA+oBd/ABahwe5IyNUBpkTovDUaUqySCIGJvKtdtwKoj9W3fxsQn1clR9706XwokdFJpQw8v1ARXcW/aT+X6ifMbcTZOR5evSByA8RYMwEQU7/ACljLCawx9BIButtMFu+/v8AaepUtueIhI9PIajI3Cd2Vl/2h21sJB5+oX25Xj6J+vsnp4fQAeuTcCrFjtsusvmlj6a5YmwABXArPG6GqI+zc96fyTGxXbIF3lQTXpNuwscc/bKo+IZvzbfTJsLbkkZVeMCZVFhn/iQtRbapYpXByw1nWXXTwzxjcJKU7lo7nUiPhSQLl8teCRT2DXOTcCKkSYOiqNKmnZmsbSXH1GYMHMnN+rzBu5v73mzSdIVH8wu7vuZmZtvqZlVeyqAAFRQAK7c2cpYNZNqJITaRssrx3sLDzEhIloFhx5m5R9l++eaDxFNK8N+SgkSFtjEBpBIgaQoS1ttJIAAP0G+/DXDoaZFuOhINR+I3vu3FqpK5TYV3bd22uQL4N55q+gRyNK5LAyqFNVQ+myAQeWCRhgbBCAVkfw71KWXyvNKHzdOkw2oV2s1WvLHcPUPjsfnimi1cxKyLMjyxwazcSl0Y5Ivy2Af0ngfej298OUK4CUr5L2Lw3GoYb3opMnZAANRtL0FUAcpY+Nx+1bYugxq7OCaa7XbH3ZdpIfZvF96DVf8ATIXTusyyanyyYlFn8skCXy9lq4G63tvfbVHvY56LLxjCXCKyclyUq9FPnadiSywRsNxIBd+AgKrQO0bz27sK98usYy8YpcFW7GMYyxAxjGAMYxgFb4g6n+GgaTu1hUHy7duPeuTX2zhOq9Sim2MIiswQK55LSkFrkJddqUbG32uhwBt7XxLpYZFiOpMghWUF/LotyjqvBB4LOo/fOBgaMH+GqABJFd2JoXwLb9LLVnn+S250dnjpabPE6xKum/CcKm4SD6fqSgKewxegDVjlRWd34T6jJNFUyuGWtrMpXzIz9Li+D2IJUkcXfOcVK6kWp+hlYsF3BKNi6/mI2/uT2BI6TwTrpZ2bzGJSJAiD+FQxuhag2NvPf2yuBtTSRbOk4WdbjGVet8Q6eGXyZJNr1dbWIAPa2AIU/qc9FtLk4km+CweH1B1ZkkHZ1+qvg3wy/wB1gRlnpuuKwMWsVQGG3fX5Lg8UwN+WT8MSORTXxlTpdZHKLjkRx/dYH/sc3EXwcwy4IZV/JpjyyxssBo00kiRwDYksnmSAMAbJVFVQQfRZBIFUPf2yrhk3tLL/AMSRm/VQdiH/ACImITJCKhKFQDsSTkREgjdG1Fk7/T2IFCu+e6eEIioOyqAP0ArMfF8eWKbbNc+ZTikjZjGM7jlGMYwDUNSm7ZvXf/LuG6h39N3mifq0CKXaVNocISGBp2IAU12Nn37ck8DKdOkvLLLe1E/El920iU1Cq+lu1ckbvgEffB8POVAJhDIsCqFUhWEEoktvi9tAC9u5uTeY6p+kaaY+2X34uOyvmJaiyNwsKexIvgffNLdUhBjHmp+axVKYEMwBJAI44r+tDuRlNL4ZJ80Eqd7SMrFpLBlNspS9hHcXXYLxxeTG6Mwn85SleeJdpBHp8gRMLH8Vjd/p98ap9EVHsnR9RQqDYDFN4Qsu/bV9gTf6ix98jzdaRV05I51BUICVFWhckknsAK4vkge+VWm8NSqIFMqEQhAOGHAhMTChwb3Fgxs/w8DnLNelMV0gZluA+qr9X5Lx8X25cH9sJzfomoonLrIzuqRDtNN6l9J+DzwfscybUoKt1F8i2HI+R85zqeGG2xIzx1EsSClP5iRzRyEuD/ERFQHIBdj75ZdU6W0j+YjqjLBLGhKhtryFCGo8cbCK++SpTrgio9kw6+LaH82PYezb12mvhro5r1/VI4doZgWZo1CgjcfMkVA1XZUFhZyv6d0Jkk3OUZd7vt9Tf7SNFItu/KE3/e7DImm8MOiRx74yA2mdmIO8HTCMEIfYN5dj43N88Q5Trgmo9nRLrIzuqRDsNNTL6T8Hn0n7HPIdbG5ASRGJFgKyklfkAHkffKCPwy22NGdKijWNaU/mKssbln/vVHVc8ux96yavRKkEgKitSZjS8kGEx1fzZu8lSn0RUey5xjGalBjGMAYxjAGMYwBjGMA16iBZFZHAKsCCD7g985E+FPJWehLLcZEHluqsr80sm8gFPpHpPueBnZYzLJijPkvDJKHBwnh7oOpjnSVolqMjb55V12gtXpUk8AihYoi7zsun6JIV2oALYsaAALMbJodh7AdgAAOBknGRjwxhuiZ5ZT5IHWuo/h491WxO1B7FyCefsACT+ld84nxlaDSo6bZFRi7Gt0jTHfuJHbhaC/w9qAAzrfFUAeAAnaBLDbH+FWkVWb9ArMf2zi+tzrqtc25ZpoN5WOS9vmMvpQhxtBUKCOCL7/rz+RKpo2wRuJt6v0rTmCCaLUEyniWMimQ0SWUgAhbFfexz7Z3HQdT5unicmyUG4/LDhv8AUHPmU0G2Z4pZREoG4bhvNE8C1o2Pvyc+heDtFJDpUSWg1swHPCsxIBB7HmyPa69snxpWyM0aRdYxjO05hjGMAYxjAKafr213jKgMm8tuYhREiKyvYU8MXRarvvq9tHRD1+R6TyQr/m7/AFsNoi2EkbogxJEgoMq8j45y5l0cbFiyIxddjWoO5OfSfleTx981wdMhQ2kUak3ZCgXuADf1CrfztGZOM75L3HooNT4hcxuqir0zssoZiwlSEMQfy1TcL/hY9uwvjLU9ckWSJJF2FWDuI3Lh4m0+oYCyq+rdCTVVwvPxdHo2nu/IivtexborsPt7r6f0zKHpUCABIY1AYOKRRTgUGFDggcfpxldE+ydUeioXxDN5fmHSkD0ndcuwIysdxPk7uCoB2qQN6m6upfU+ptG67EaS4XcKp4NPELoIWag5Pp5oH0kkVJ/sTTbdnkRbbvbsWuxHavgkV9z85v1Ohjk+uNGoULUGhYND45VT+qj4y2mdbsi43wQZ+rNsgMaI7TvsH5jKgIjdz6jHu/3ZFbQee3tlefFR2sRCDsVd3rJ/MaaSAKtIdy+ZH9XHpN1fGWut6NFIIUKqI4X3BNo2n8t0ArsK37r+VGSF6fEFKiKPaUCFdq0YxdIRVFRubjtycip9k3Hoq165IPL8yDywzlWdjIEB3KFomK/VuNbwgtavkZG03ieSSMSjTUrmLyizOARLIEG5jFSkBg3p3jvzxzcjpMA2/kx+g2vpHBsGx97AP6gZknS4VJIijBLBjSjlg24Ht33eq/nnGnJ2Lh0Vmh6vNJqEjMcartm8z1sSHikVfSdg3L6h3r6j22019kSXpkLfVEh+vuo/3n1/5vf5yWBl4prkq2vQxjGXKjGMYAxjGAMYxgDGMYAxjGAMYxgGnW6VJo2ikFo4phZFg/ccjKDX+D0kRYxNKqIAFQ7WUUKHsGND5bOlxlJY4y5RaM5R4Zz2g8MKkqSSCIiMegRx7Lf+d7Y7iK4+CSe9V0OMYhjjBVESk5O2MYxlyoxnKDxRN5if/jnynfao58wqP469hRBqu3vl63VY1Yq1ghtv0sR7USQKWywHPvmayRZd45InYyA3WYAQPMHqquDXqCkWaoA717/zDMU63EareQVDA+XJTBmKgAbbJJHb3HOTrj2RpfRY4yv/ALag59fA7na9Xt3bd1Vu287e/wBswl65FQKEsSVFU4A3PsO47fQQd3Bonaca49jTLos8ZD0vU45GCKfUQT9LbTtrdTkANRIBrscmZZNPghprkYxjJIGMYwBjGMAYxjAGMYwBjGMAYxjAGMYwBjGMAYxjAGMYwBjGMAYxjAGMYwCqXoEQdmuSmfeybvQXNcnjcRwPSTt4HGTDoUJY7eWIJ5PdSCPf5AxjK6UTqZrj6TEu3apG0kimYfU243R5F9geB2HGYr0eIdgw+4d7u7u91k37/c/JxjGiPQ1Ps1RdCiBewWDGwpZ6H5apdbuWoE7+/q/fNx6REa4biv4352sWG71eqiTV3jGRoj0TqfZlpulxRsHQEEAgDc5UBiC1KTQJKgk13v5OTMYyySXBDbYxjGSQMYxgDGMYAxjGAMYxgDGMYAxjGAf/2Q==" class="img-fluid figure-img"></p>
<figcaption>Monte Carlo definition by Investopedia</figcaption>
</figure>
</div>
<p>GREAT NEWS! I just got hired at Baruch college for the position as an ESOL professor. Iâ€™m at a difficult point, where I must choose one of two <a href="https://www.cuny.edu/wp-content/uploads/sites/4/page-assets/about/administration/offices/hr/benefits/Benefits-Guide-Retirement-Plans-Final-HEO-and-ECP.pdf">retirement plans</a> offered : TRS &amp; ORP. TRS is a pension plan, and ORP is like a 401K. To help me with my decision I will be analyzing a few metrics and sets of data, see below. Dive in and help me on this hard decision. Iâ€™ll take you through my analysis process and decision.</p>
<section id="data-sources" class="level5">
<h5 class="anchored" data-anchor-id="data-sources">Data sources:</h5>
<p><a href="https://fred.stlouisfed.org/docs/api/fred/series_observations.html">Federal Reserve Bank of Saint Louis</a> : US Economic data API</p>
<p>Metrics:</p>
<ol type="1">
<li>CPI as <em>Inflation Data</em></li>
<li>International Stock market as <em>International Equity Market total returns data</em></li>
<li>US Monthly Treasury Yields as <em>Short Term Debt Returns</em></li>
</ol>
<p><a href="https://www.alphavantage.co/documentation/">Alpha Vantage</a> : free financial market data API</p>
<p>Metrics:</p>
<ol type="1">
<li>S&amp;P 500 as <em>US equity data</em></li>
<li>10 Treasury Yield as <em>Bond Market total returns data</em></li>
<li>Real GDP as <em>Wage Growth data</em></li>
</ol>
<p>Iâ€™ve requested a set of keys from the sources in order to extract data from itâ€™s APIs. After completing these tasks, I then extracted and created data frames for the metrics above and analyzed each. See code below for code of extraction.</p>
<p>My keys:</p>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR EXTRACTING AND CREATING DATA FRAME FOR ALPHA DATA</strong>
</summary>
<p>&lt;/summary&gt;</p>
<p>``` r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># FRED OBSERVATIONS DATA - INFLATION </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>fred_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"CPIAUCSL"</span>,    <span class="co"># Series ID = consumer price index for urban consumers/ Inflation data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>fred_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>fred_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_response)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> fred_data<span class="sc">$</span>observations</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># FRED OBSERVATIONS DATA - IR14270 (if available, for international stock market data), values are lin= actual price/actual value</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>fred_int_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"IR14270"</span>,     <span class="co"># Series ID = International stock market</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>fred_int_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_int_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>fred_int_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_int_response)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>observations_int <span class="ot">&lt;-</span> fred_int_data<span class="sc">$</span>observations</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>observations_int_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations_int, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations_int, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="do">####### SHORT TERM DEBT RETURS [STDR] - USE MONTHLY TREASURY YIELDS with units= lin[percentage]</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>fred_stdr_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"DGS1MO"</span>,     <span class="co"># Series ID = Treasury Yiields</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>fred_stdr_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_stdr_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>fred_stdr_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_stdr_response)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>observations_stdr <span class="ot">&lt;-</span> fred_stdr_data<span class="sc">$</span>observations</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>observations_stdr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations_stdr, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations_stdr, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR EXTRACTING AND CREATING DATA FRAME FOR <strong>ALPHA DATA</strong></strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ALPHAVANTAGE DATA - US EQUITY </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"SPY"</span>,  <span class="co">#s%p 500, US equity data </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>sp_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(req)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the time series data (the 'Time Series (Monthly)' part)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sp_time_series <span class="ot">&lt;-</span> sp_data[[<span class="st">"Monthly Time Series"</span>]] </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it into a data frame</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>sp_time_series_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">names</span>(sp_time_series)),  <span class="co"># Convert dates to Date class</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">open =</span> <span class="fu">sapply</span>(sp_time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"1. open"</span>]])),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">high =</span> <span class="fu">sapply</span>(sp_time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"2. high"</span>]])),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">low =</span> <span class="fu">sapply</span>(sp_time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"3. low"</span>]])),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">close =</span> <span class="fu">sapply</span>(sp_time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"4. close"</span>]])),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">volume =</span> <span class="fu">sapply</span>(sp_time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"5. volume"</span>]])),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="do">#### ALPHAVANTAGE DATA - 10 YEAR TREASURY BOND YIELD in percent </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>bond_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TREASURY_YIELD"</span>, </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">interval =</span> <span class="st">"monthly"</span>,  </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>bond_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(bond_req)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and process the bond data</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>bond_df_data <span class="ot">&lt;-</span> bond_data<span class="sc">$</span>data </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract 'date' and 'value' from bond_df_data</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(bond_df_data, <span class="cf">function</span>(x) x<span class="sc">$</span>date)  <span class="co"># Extract 'date'</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(bond_df_data, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x<span class="sc">$</span>value))  <span class="co"># Extract 'value' and convert to numeric</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(dates),  <span class="co"># Convert 'date' to Date class</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> values,  <span class="co"># Numeric 'value'</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="do">### REAL GDP, as GDP INCREASES SO DOES WAGE GROWTH in Billions of dollars </span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.alphavantage.co/query?function=REAL_GDP&amp;interval=annual&amp;apikey=demo</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>gdp_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"REAL_GDP"</span>, </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">interval =</span> <span class="st">"annual"</span>,  </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(gdp_req)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and process the bond data</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>gdp_df_data <span class="ot">&lt;-</span> gdp_data<span class="sc">$</span>data </span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract 'date' and 'value' from bond_df_data</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(gdp_df_data, <span class="cf">function</span>(x) x<span class="sc">$</span>date)  <span class="co"># Extract 'date'</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(gdp_df_data, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x<span class="sc">$</span>value))  <span class="co"># Extract 'value' and convert to numeric</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>gdp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(dates),  <span class="co"># Convert 'date' to Date class</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> values,  <span class="co"># Numeric 'value'</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
</section>
<section id="economy-analysis" class="level4">
<h4 class="anchored" data-anchor-id="economy-analysis">Economy Analysis</h4>
<p>I will now dive into my initial economic analysis based on the metrics described at the beginning. Iâ€™m looking for trends that stand out. Here are some findings I came across and graphs to help us better understand.</p>
<section id="sp-500-as-us-equity-data" class="level5">
<h5 class="anchored" data-anchor-id="sp-500-as-us-equity-data"><strong>S&amp;P 500 as <em>US equity data</em></strong></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH S&amp;P500_US EQUITY - Monthly Average High and Low Values</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TIME_SERIES_MONTHLY"</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">symbol =</span> <span class="st">"SPY"</span>,  <span class="co">#s%p 500, US equity data </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(req)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Inspect the structure of the data</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the time series data (the 'Time Series (Monthly)' part)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>time_series <span class="ot">&lt;-</span> data[[<span class="st">"Monthly Time Series"</span>]] </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it into a data frame</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>time_series_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">names</span>(time_series)),  <span class="co"># Convert dates to Date class</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">open =</span> <span class="fu">sapply</span>(time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"1. open"</span>]])),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">high =</span> <span class="fu">sapply</span>(time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"2. high"</span>]])),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">low =</span> <span class="fu">sapply</span>(time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"3. low"</span>]])),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">close =</span> <span class="fu">sapply</span>(time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"4. close"</span>]])),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">volume =</span> <span class="fu">sapply</span>(time_series, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x[[<span class="st">"5. volume"</span>]])),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows of the data</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(time_series_df)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month (and possibly year if you want to avoid year-based aggregation)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>monthly_avg_df <span class="ot">&lt;-</span> time_series_df <span class="sc">|&gt;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date to the start of the month</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by month</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_open =</span> <span class="fu">mean</span>(open, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_high =</span> <span class="fu">mean</span>(high, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_low =</span> <span class="fu">mean</span>(low, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_close =</span> <span class="fu">mean</span>(close, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_volume =</span> <span class="fu">mean</span>(volume, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first few rows of the monthly averages</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(monthly_avg_df)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for ggplot</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>monthly_avg_high_low <span class="ot">&lt;-</span> monthly_avg_df <span class="sc">|&gt;</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month, avg_high, avg_low) <span class="sc">|&gt;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"metric"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>month)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(monthly_avg_high_low)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly high and low averages over time</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>ssplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_avg_high_low, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> value, <span class="at">color =</span> metric)) <span class="sc">+</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> .<span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># Line plot for high and low values</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span>  <span class="co"># Points to mark data points</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"S&amp;P500_US EQUITY - Monthly Average High and Low Values"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average $ Value "</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="S&amp;P MP4.PNG" class="img-fluid figure-img"></p>
<figcaption>Alt text</figcaption>
</figure>
</div>
<p>I am using the S&amp;P 500 to portray US Equity. The S&amp;P 500 index reflects the 500 largest publicly traded companies in the US., spanning from industries such as healthcare, finance, consumer goods, and energy. I can conclude that the better the S&amp;P performs the better it reflects US equity. In other words an upward trend = growth, downward trend = difficulties.</p>
<p>From this graph, in a spam of 20+ years, we have a healthy upward trend, we have growth. However, zooming into chunks of years, particularly in recent years there seems to be a steeper spike upwards, perhaps too healthy a market. As we also see from the graph, after a spike comes a drop. For example zooming into years 2007-2008sh, a spike happened around 2007 when suddenly dropped in 2008. Of course we must consider historical events, in 2008 the stock market crashed due to a housing bubble. As another example, we see another big slope up and then down from 2020-2021, the historical event for this was Covid-19.</p>
<p>To conclude on this graph, US equity looks fantastico in a longer time span and bad on a short time span. But increasing either way.</p>
</section>
<section id="treasury-yield-as-bond-market-total-returns-data" class="level5">
<h5 class="anchored" data-anchor-id="treasury-yield-as-bond-market-total-returns-data">10 Treasury Yield as <em>Bond Market total returns data</em></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH 10 Year Treasury Bond Yield; Bond Market Returns - Monthly Average % values</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bond_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"TREASURY_YIELD"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">interval =</span> <span class="st">"monthly"</span>,  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>bond_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(bond_req)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and process the bond data</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>bond_df_data <span class="ot">&lt;-</span> bond_data<span class="sc">$</span>data </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract 'date' and 'value' from bond_df_data</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(bond_df_data, <span class="cf">function</span>(x) x<span class="sc">$</span>date)  <span class="co"># Extract 'date'</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(bond_df_data, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x<span class="sc">$</span>value))  <span class="co"># Extract 'value' and convert to numeric</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>bond_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(dates),  <span class="co"># Convert 'date' to Date class</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> values,  <span class="co"># Numeric 'value'</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month (and possibly year if you want to avoid year-based aggregation)</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>monthly_bondavg_df <span class="ot">&lt;-</span> bond_df <span class="sc">|&gt;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date to the start of the month</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by month</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for ggplot</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>monthly_bondavg_plotdata <span class="ot">&lt;-</span> monthly_bondavg_df <span class="sc">|&gt;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month, avg_value) <span class="sc">|&gt;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"metric"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>month)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly high and low averages over time</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>tenyear_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_bondavg_plotdata, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> value, <span class="at">color =</span> metric)) <span class="sc">+</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> .<span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># Line plot for high and low values</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span>  <span class="co"># Points to mark data points</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"10 Year Treasury Bond Yield; Bond Market Returns - Monthly Average % values"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average % Value "</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10 year treasury bond mp4.PNG" class="img-fluid figure-img"></p>
<figcaption>This is an image</figcaption>
</figure>
</div>
<p>For this graph I have the 10 year Treasury Bond reflecting Bond Market returns over time. The 10 year Treasury Bond Yield is the percent interest paid by government for borrowed money for 10 years. The higher the % interest the more money payed back to investors/lenders the better. As it is government backed, it is considered a safe investment.</p>
<p>From the graph we also see % rates rise up until 1980s and then fall. Rising rate means confidence in the economy, higher bond prices, higher returns. Falling rates mean low confidence in the economy, lower bond prices, lower returns.</p>
<p>Quick note: The 1980â€™s represent an era of consumerism and materialism, as well as the birth of MTV! In the 1990s the internet takes the house.</p>
<p>So it looks like confidence for investors is growing from 2020 on, perhaps from higher returns from this bond investment. If history repeats itself and should the 10 year treasury bond reach a 10%+ yield such as that of the 1980s, than it may just be a good time to invest in this bond and wait till it reaches peakâ€¦â€¦or not? Caution and further research must be done.</p>
</section>
<section id="real-gdp-as-wage-growth-data" class="level5">
<h5 class="anchored" data-anchor-id="real-gdp-as-wage-growth-data">Real GDP as <em>Wage Growth data</em></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH Real GDP; Wage Growth - Monthly Average Billion $s</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gdp_req <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.alphavantage.co/query"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="st">`</span><span class="at">function</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"REAL_GDP"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">interval =</span> <span class="st">"annual"</span>,  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">apikey =</span> API_KEY) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>() </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JSON response</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(gdp_req)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and process the bond data</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>gdp_df_data <span class="ot">&lt;-</span> gdp_data<span class="sc">$</span>data </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract 'date' and 'value' from bond_df_data</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(gdp_df_data, <span class="cf">function</span>(x) x<span class="sc">$</span>date)  <span class="co"># Extract 'date'</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(gdp_df_data, <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x<span class="sc">$</span>value))  <span class="co"># Extract 'value' and convert to numeric</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>gdp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(dates),  <span class="co"># Convert 'date' to Date class</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> values,  <span class="co"># Numeric 'value'</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Avoid factors</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month (and possibly year if you want to avoid year-based aggregation)</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>monthly_gdpavg_df <span class="ot">&lt;-</span> gdp_df <span class="sc">|&gt;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date to the start of the month</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by month</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for ggplot</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>monthly_gdpavg_plotdata <span class="ot">&lt;-</span> monthly_gdpavg_df <span class="sc">|&gt;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(month, avg_value) <span class="sc">|&gt;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"metric"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>month)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly high and low averages over time</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>realgdp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_gdpavg_plotdata, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> value, <span class="at">color =</span> metric)) <span class="sc">+</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> .<span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># Line plot for high and low values</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span>  <span class="co"># Points to mark data points</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Real GDP; Wage Growth - Monthly Average Billion $"</span>,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Billion $ "</span>,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Metric"</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<p>For this graph I use Real GDP as an indicator of Wage Growth. Real GDP is another indicator of the economy health, it measures the values of goods and services produced in a period of time. One conclusion Iâ€™ve made is that a rise in goods and services is a result of a rise in demand for goods, if effect then is a rise in labor to meet demand,and hence a rise in wages to fill labor gaps = wage growth.</p>
<p>So, I can safely say that because Real GDP has been rising , wages will also continue to rise. This also confirms that my wage will continue to increase over time, more money in my bag, more money to save! But how true is that? I must find a way to maintain the same expenses until I retire, frugality is keyâ€¦.maybe just maybe in order to preserve this trend and bag more cash in my pocket I will cut on some proteins and carbs when prices of goods rise. No more Turkey for me.</p>
</section>
<section id="cpi-as-inflation-data" class="level5">
<h5 class="anchored" data-anchor-id="cpi-as-inflation-data">CPI as <em>Inflation Data</em></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH - Monthly CPI (Consumer Price Index) Over Time as INFLATION</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fred_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"CPIAUCSL"</span>,    <span class="co"># Series ID = consumer price index for urban consumers/ Inflation data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>fred_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fred_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_response)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> fred_data<span class="sc">$</span>observations</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>observations_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(observations_df<span class="sc">$</span>date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)  <span class="co"># convert date chr to date</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Downsample to monthly data by grouping and summarizing</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># We can summarize by taking the average for each month (or any other summary statistic)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>monthly_data <span class="ot">&lt;-</span> observations_df <span class="sc">|&gt;</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date down to the start of the month</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by the rounded month</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_value =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(value), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="co"># Summarize the values (e.g., average)</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly data using ggplot2 with a trend line</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>cpi_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> monthly_value)) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span>              <span class="co"># Line plot</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> .<span class="dv">05</span>) <span class="sc">+</span>              <span class="co"># Points on the line</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span>  <span class="co"># Add a linear trend line</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly CPI (Consumer Price Index) Over Time: INFLATION"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average CPI Value"</span>) <span class="sc">+</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For this graph I use CPI[Consumer price index] to evaluate inflation. Or should I call it Inflammationâ€¦because boy does this hurt, especially when it rises quickly such as what we have seen happen sometime after 2020. There goes my frugality from wage growth savings. Back to analysis. CPI is a measure of prices paid by consumers for services and goods. Hence the rise reflects the rise in expenses, the consumer is paying more for goods and services. I am paying more for rice with chicken!!</p>
<p>To conclude here, inflation will kill my savings. Perhaps if it falls below the trend line Iâ€™m relatively safe?â€¦..</p>
</section>
<section id="international-stock-market-as-international-equity-market-total-returns-data" class="level5">
<h5 class="anchored" data-anchor-id="international-stock-market-as-international-equity-market-total-returns-data">International Stock market as <em>International Equity Market total returns data</em></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH - Monthly International Stock Market Avg. Value Over Time</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fred_int_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"IR14270"</span>,     <span class="co"># Series ID = International stock market</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>fred_int_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_int_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>fred_int_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_int_response)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>observations_int <span class="ot">&lt;-</span> fred_int_data<span class="sc">$</span>observations</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>observations_int_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations_int, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations_int, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>observations_int_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(observations_int_df<span class="sc">$</span>date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)  <span class="co"># convert date chr to date</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Downsample to monthly data by grouping and summarizing</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># We can summarize by taking the average for each month (or any other summary statistic)</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>monthly_int_data <span class="ot">&lt;-</span> observations_int_df <span class="sc">|&gt;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date down to the start of the month</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by the rounded month</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_value =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(value), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="co"># Summarize the values (e.g., average)</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly data using ggplot2 with a trend line</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>internationalstock_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_int_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> monthly_value)) <span class="sc">+</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span>              <span class="co"># Line plot</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span>              <span class="co"># Points on the line</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">025</span>) <span class="sc">+</span>  <span class="co"># Add a linear trend line</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly International Stock Market Avg. Value Over Time"</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average $ Value"</span>) <span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For this graph I look at International stock market data for International Equity analysis. The international stock market measure stocks that are international to the investors country of investment. In contrast to S&amp;P 500 that measures US only equities.</p>
<p>From the graph, the overall trend is rising, we do see time periods for grater equity; peaks; rises , such as those in 2010-2012sh and most recently 2023-2024sh.</p>
<p>I will conclude that investing in international markets will diversify my investments and potentially level up any losses [if any] had by investing on S&amp;P.</p>
</section>
<section id="us-monthly-treasury-yields-as-short-term-debt-returns" class="level5">
<h5 class="anchored" data-anchor-id="us-monthly-treasury-yields-as-short-term-debt-returns">US Monthly Treasury Yields as <em>Short Term Debt Returns</em></h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE FOR GRAPH - US Monthly Treasury Yield % ; Short Term Debt Returns Over Time</strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters and request</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fred_url <span class="ot">&lt;-</span> <span class="st">"https://api.stlouisfed.org/fred/series/observations"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>fred_stdr_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">series_id =</span> <span class="st">"DGS1MO"</span>,     <span class="co"># Series ID = Treasury Yields</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">api_key =</span> fred_api_key,    <span class="co"># API key</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_type =</span> <span class="st">"json"</span>,        <span class="co"># Specify response format as JSON</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date =</span> <span class="st">"2000-01-01"</span>, <span class="co"># Optional start date for data</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="st">"2020-01-01"</span>    <span class="co"># Optional end date for data</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Send the GET request for series information</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>fred_stdr_response <span class="ot">&lt;-</span> <span class="fu">request</span>(fred_url) <span class="sc">|&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_url_query</span>(<span class="sc">!!!</span>fred_stdr_params) <span class="sc">|&gt;</span>  <span class="co"># Pass query parameters</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>fred_stdr_data <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(fred_stdr_response)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the observations data from the response</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>observations_stdr <span class="ot">&lt;-</span> fred_stdr_data<span class="sc">$</span>observations</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert it to a data frame for easier analysis</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>observations_stdr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">sapply</span>(observations_stdr, <span class="cf">function</span>(x) x<span class="sc">$</span>date),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">sapply</span>(observations_stdr, <span class="cf">function</span>(x) x<span class="sc">$</span>value)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>observations_stdr_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(observations_stdr_df<span class="sc">$</span>date, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>)  <span class="co"># convert date chr to date</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Downsample to monthly data by grouping and summarizing</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># We can summarize by taking the average for each month (or any other summary statistic)</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>monthly_stdr_data <span class="ot">&lt;-</span> observations_stdr_df <span class="sc">|&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span>  <span class="co"># Round the date down to the start of the month</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span>  <span class="co"># Group by the rounded month</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_value =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(value), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="co"># Summarize the values (e.g., average)</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the monthly data using ggplot2 with a trend line</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>monthly_treasuryyield <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(monthly_stdr_data, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> monthly_value)) <span class="sc">+</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> .<span class="dv">2</span>) <span class="sc">+</span>              <span class="co"># Line plot</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span>              <span class="co"># Points on the line</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">05</span>) <span class="sc">+</span>  <span class="co"># Add a linear trend line</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Monthly Treasury Yield % ; Short Term Debt Returns Over Time"</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average % Values"</span>) <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this graph I can conclude that this is like a heart beat EKG under stress. I am analyzing the US monthly treasury yield to view any short term debt return trends. The US monthly Treasury yield is like the 10 year yield, interest payed by government for borrowed money, but monthly. Again, itâ€™s an indicator of economy health in a short term.</p>
<p>As % yields rise, so does short term debt returns. Meaning, more short term debts are payed-off/ returned with higher % rates. As % yields fall, so does short term debt returns. That makes sense, government wants to pay off higher rate loans, a money loss for them. However it looks like, from the graph, in a time period between 2007-2017sh, yields are relatively low and stagnant. The same happens sometime between 2020-2022. Is it stress? less borrowing?</p>
<p>In terms of favoring my retirement, maybe investing/ lending when rates are increasing will be a plus. I will be collecting greater interest, lets hope this is the trend when itâ€™s time for me to retire.</p>
</section>
</section>
<section id="monthly-retirement-returns-from-trs-orp" class="level4">
<h4 class="anchored" data-anchor-id="monthly-retirement-returns-from-trs-orp">Monthly retirement returns from TRS &amp; ORP</h4>
<section id="trs" class="level5">
<h5 class="anchored" data-anchor-id="trs">TRS</h5>
<p>After Economy analysis I will now calculate monthly Benefits for the TRS plan and potential monthly benefits for ORP.</p>
<p>Iâ€™ll First calculate TRS. I will keep in mind that TRS benefit is a pension benefit. When itâ€™s time for me to retire I will receive a check at/near monthly equal amounts for the remainder of my life [till death.] The downside of this is that once itâ€™s time for me to retire, and should markets perform higher hence provide higher returns, I will not reap those benefits. Itâ€™s one stable check market win or loose.</p>
<details>
<summary>
<strong>CLICK TO VIEW CODE </strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>calculate_benefit <span class="ot">&lt;-</span> <span class="cf">function</span>(FAS, N, CPI) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Calculate base benefit</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (N <span class="sc">&lt;=</span> <span class="dv">20</span>) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    base_benefit <span class="ot">&lt;-</span> <span class="fl">1.67</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> FAS <span class="sc">*</span> N</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (N <span class="sc">==</span> <span class="dv">20</span>) {</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    base_benefit <span class="ot">&lt;-</span> <span class="fl">1.75</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> FAS <span class="sc">*</span> N</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    base_benefit <span class="ot">&lt;-</span> (<span class="dv">35</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> (N <span class="sc">-</span> <span class="dv">20</span>)) <span class="sc">*</span> FAS</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: Calculate inflation adjustment</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  inflation_adjustment <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> CPI</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  inflation_adjustment <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(inflation_adjustment <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">10</span>  <span class="co"># Round up to nearest tenth</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cap inflation adjustment between 1% and 3%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (inflation_adjustment <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    inflation_adjustment <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (inflation_adjustment <span class="sc">&gt;</span> <span class="dv">3</span>) {</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    inflation_adjustment <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: Apply inflation adjustment to base benefit</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  adjusted_benefit <span class="ot">&lt;-</span> base_benefit <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_adjustment <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the adjusted benefit</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adjusted_benefit)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>FAS <span class="ot">&lt;-</span> <span class="dv">90000</span>  <span class="co"># Example Final Average Salary</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">20</span>       <span class="co"># Example number of years served</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>CPI <span class="ot">&lt;-</span> <span class="dv">300</span>    <span class="co"># Example CPI </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this example TRS benefit I used 90k as my final average salary. I can adjust accordingly on my R code. Here are my monthly Benefits for the TRS plan based on these metrics.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2580.15</code></pre>
</div>
</div>
</section>
<section id="orp" class="level5">
<h5 class="anchored" data-anchor-id="orp">ORP</h5>
<p>I will now explore ORP monthly benefits. The ORP benefit is like a 401k, so if markets are performing well in my retirement then I potentially have greater monthly benefits or maybe longer benefits. I must keep in mind this is not forever [till death], so itâ€™s important to invest well as well as to be cognizant of how much I will extract yearly for whatever number of years I think I will continue to live after retirement. So I guess one of the bigger downside is this plan will keep me alert on the number of years I will be alive - jaja. I also have a risk of markets not performing well. Unless of course Iâ€™m an excellent money manager and investor. In any case letâ€™s look at the numbers. Here are my monthly benefits :</p>
<details>
<summary>
<strong>CLICK TO VIEW CODE </strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CALCULATING ORP BENEFIT </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to calculate total savings</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>calculate_orp_savings <span class="ot">&lt;-</span> <span class="cf">function</span>(initial_salary, salary_increase_rate, years_at_cuny, starting_age) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the asset allocation and average returns for each period</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  asset_allocation <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_25_49 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.54</span>, <span class="at">International_Equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.10</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_50_59 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.47</span>, <span class="at">International_Equities =</span> <span class="fl">0.32</span>, <span class="at">Bonds =</span> <span class="fl">0.21</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_60_74 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.34</span>, <span class="at">International_Equities =</span> <span class="fl">0.23</span>, <span class="at">Bonds =</span> <span class="fl">0.43</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_75_plus =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.19</span>, <span class="at">International_Equities =</span> <span class="fl">0.13</span>, <span class="at">Bonds =</span> <span class="fl">0.62</span>, <span class="at">Short_Term_Debt =</span> <span class="fl">0.06</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  returns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.07</span>, <span class="at">International_Equities =</span> <span class="fl">0.06</span>, <span class="at">Bonds =</span> <span class="fl">0.04</span>, <span class="at">Short_Term_Debt =</span> <span class="fl">0.02</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to compute contributions</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  calc_contributions <span class="ot">&lt;-</span> <span class="cf">function</span>(salary, years) {</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    contributions <span class="ot">&lt;-</span> <span class="fu">numeric</span>(years)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">45000</span>) {</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.03</span> <span class="sc">*</span> salary</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">55000</span>) {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.035</span> <span class="sc">*</span> salary</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">75000</span>) {</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.045</span> <span class="sc">*</span> salary</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">100000</span>) {</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.0575</span> <span class="sc">*</span> salary</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.06</span> <span class="sc">*</span> salary</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (year <span class="sc">&lt;=</span> <span class="dv">7</span>) {</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        employer_contrib <span class="ot">&lt;-</span> <span class="fl">0.08</span> <span class="sc">*</span> salary</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>        employer_contrib <span class="ot">&lt;-</span> <span class="fl">0.10</span> <span class="sc">*</span> salary</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>      total_contrib <span class="ot">&lt;-</span> employee_contrib <span class="sc">+</span> employer_contrib</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>      contributions[year] <span class="ot">&lt;-</span> total_contrib</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>      salary <span class="ot">&lt;-</span> salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> salary_increase_rate)  <span class="co"># Salary increases yearly</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(contributions)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate contributions for all years</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  contributions <span class="ot">&lt;-</span> <span class="fu">calc_contributions</span>(initial_salary, years_at_cuny)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate asset growth by age range</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  total_savings <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  current_age <span class="ot">&lt;-</span> starting_age</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years_at_cuny) {</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine the asset allocation based on age</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">75</span>) {</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>      allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_75_plus</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">60</span>) {</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>      allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_60_74</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">50</span>) {</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>      allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_50_59</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>      allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_25_49</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the return for this year</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(allocation <span class="sc">*</span> returns)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    total_savings <span class="ot">&lt;-</span> total_savings <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> growth_rate) <span class="sc">+</span> contributions[year]</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Increase the age by 1 year</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    current_age <span class="ot">&lt;-</span> current_age <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total_savings)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<p>For this ORP benefit example I am assuming the below scenario. Iâ€™m am also calculating 20 years of retirement</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>initial_salary <span class="ot">&lt;-</span> <span class="dv">65000</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>salary_increase_rate <span class="ot">&lt;-</span> <span class="fl">0.03</span>  <span class="co"># 3% annual increase in salary</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>years_at_cuny <span class="ot">&lt;-</span> <span class="dv">20</span>           <span class="co"># Employee works 20 years at CUNY</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>starting_age <span class="ot">&lt;-</span> <span class="dv">25</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#NOTE: 20 years monthly benefits after retirement#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2110.913</code></pre>
</div>
</div>
<p>With both Calculations there are a ton of things to keep in mind. For TRS Iâ€™m assuming a 90K AVG salary at end of my tenure. It could be more or less. For ORP, I am assuming a 65K starting salary with monthly increase rate at 3%, but we must also consider market performance. Also could be more or less. So these numbers are just estimates.</p>
</section>
</section>
<section id="monte-carlo-analysis" class="level4">
<h4 class="anchored" data-anchor-id="monte-carlo-analysis">MONTE CARLO ANALYSIS</h4>
<p>So I want to have more confidence of my future returns. I will now apply the Monte Carlo analysis to my calculations. Here are my results:</p>
<section id="trs-1" class="level5">
<h5 class="anchored" data-anchor-id="trs-1">TRS</h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE </strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### APPLY MONTE CARLO TO TRS </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">### # Load necessary library</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># For simulating random variables (like FAS and CPI)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate the retirement benefit with Monte Carlo Analysis</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>monte_carlo_benefit_trs <span class="ot">&lt;-</span> <span class="cf">function</span>(initial_FAS, mean_CPI, sd_CPI, mean_years_served, sd_years_served, <span class="at">num_simulations =</span> <span class="dv">200</span>) {</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to calculate the benefit</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  calculate_benefit_trs <span class="ot">&lt;-</span> <span class="cf">function</span>(FAS, N, CPI) {</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: Calculate base benefit</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (N <span class="sc">&lt;=</span> <span class="dv">20</span>) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>      base_benefit <span class="ot">&lt;-</span> <span class="fl">1.67</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> FAS <span class="sc">*</span> N</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (N <span class="sc">==</span> <span class="dv">20</span>) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      base_benefit <span class="ot">&lt;-</span> <span class="fl">1.75</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> FAS <span class="sc">*</span> N</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>      base_benefit <span class="ot">&lt;-</span> (<span class="dv">35</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> (N <span class="sc">-</span> <span class="dv">20</span>)) <span class="sc">*</span> FAS</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: Calculate inflation adjustment</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    inflation_adjustment <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> CPI</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    inflation_adjustment <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(inflation_adjustment <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">/</span> <span class="dv">10</span>  <span class="co"># Round up to nearest tenth</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cap inflation adjustment between 1% and 3%</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (inflation_adjustment <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>      inflation_adjustment <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (inflation_adjustment <span class="sc">&gt;</span> <span class="dv">3</span>) {</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>      inflation_adjustment <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3: Apply inflation adjustment to base benefit</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    adjusted_benefit <span class="ot">&lt;-</span> base_benefit <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> inflation_adjustment <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the adjusted benefit</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(adjusted_benefit)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monte Carlo Simulation</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  simulation_results_trs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_simulations)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate FAS (Final Average Salary) as a normal distribution</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    FAS <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> initial_FAS, <span class="at">sd =</span> <span class="dv">5000</span>)  <span class="co"># Mean FAS and standard deviation</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate Years of Service (N) as a normal distribution (or you can use uniform)</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> mean_years_served, <span class="at">sd =</span> sd_years_served))</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">max</span>(N, <span class="dv">1</span>)  <span class="co"># Ensure at least 1 year of service</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate CPI (Consumer Price Index) as a normal distribution</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    CPI <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> mean_CPI, <span class="at">sd =</span> sd_CPI)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the benefit for this simulation</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    benefit <span class="ot">&lt;-</span> <span class="fu">calculate_benefit</span>(FAS, N, CPI)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the result of this simulation</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    simulation_results_trs[sim] <span class="ot">&lt;-</span> benefit</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return simulation results (mean, standard deviation, and percentiles)</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  results_trs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(simulation_results_trs),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(simulation_results_trs),</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(simulation_results_trs),</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(simulation_results_trs),</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">p10 =</span> <span class="fu">quantile</span>(simulation_results_trs, <span class="fl">0.10</span>),</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">p90 =</span> <span class="fu">quantile</span>(simulation_results_trs, <span class="fl">0.90</span>)</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_trs)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Usage of Monte Carlo Simulation</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>initial_FAS <span class="ot">&lt;-</span> <span class="dv">90000</span>     <span class="co"># Mean Final Average Salary</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>mean_CPI <span class="ot">&lt;-</span> <span class="dv">300</span>          <span class="co"># Expected CPI (e.g., inflation rate)</span></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>sd_CPI <span class="ot">&lt;-</span> <span class="dv">10</span>             <span class="co"># Standard deviation for CPI</span></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>mean_years_served <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># Mean number of years served</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>sd_years_served <span class="ot">&lt;-</span> <span class="dv">2</span>     <span class="co"># Standard deviation for years served</span></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Monte Carlo Simulation with 10,000 iterations</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>simulation_trs_results <span class="ot">&lt;-</span> <span class="fu">monte_carlo_benefit_trs</span>(initial_FAS, mean_CPI, sd_CPI, mean_years_served, sd_years_served, <span class="at">num_simulations =</span> <span class="dv">200</span>)</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming simulation_trs_results contains summary statistics</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>simulation_trs_results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fl">31587.42</span>,</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fl">4174.008</span>,</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fl">22687.68</span>,</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fl">42848.84</span>,</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">p10 =</span> <span class="fl">26792.82</span>,</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90 =</span> <span class="fl">37691.25</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Divide each value in the results by 240</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>simulation_trs_results_monthly <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_trs_results, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the results into a data frame for easy viewing</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>simulation_trs_results_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">names</span>(simulation_trs_results_monthly),</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">Monthly_Value =</span> <span class="fu">unlist</span>(simulation_trs_results_monthly)</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     Statistic Monthly_Value
mean      mean      2632.285
sd          sd       347.834
min        min      1890.640
max        max      3570.737
p10        p10      2232.735
p90        p90      3140.938</code></pre>
</div>
</div>
</section>
<section id="orp-1" class="level5">
<h5 class="anchored" data-anchor-id="orp-1">ORP</h5>
<details>
<summary>
<strong>CLICK TO VIEW CODE </strong>
</summary>
<p>```r</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">###MONTE CARLO FOR ORP</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># For simulating random variables (like salary increases and returns)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to calculate ORP savings with randomness (Monte Carlo Simulation)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>monte_carlo_orp_savings <span class="ot">&lt;-</span> <span class="cf">function</span>(initial_salary, salary_increase_rate, years_at_cuny, starting_age, <span class="at">num_simulations =</span> <span class="dv">200</span>) {</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the asset allocation and average returns for each period</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  asset_allocation <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_25_49 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.54</span>, <span class="at">International_Equities =</span> <span class="fl">0.36</span>, <span class="at">Bonds =</span> <span class="fl">0.10</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_50_59 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.47</span>, <span class="at">International_Equities =</span> <span class="fl">0.32</span>, <span class="at">Bonds =</span> <span class="fl">0.21</span>),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_60_74 =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.34</span>, <span class="at">International_Equities =</span> <span class="fl">0.23</span>, <span class="at">Bonds =</span> <span class="fl">0.43</span>),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_75_plus =</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.19</span>, <span class="at">International_Equities =</span> <span class="fl">0.13</span>, <span class="at">Bonds =</span> <span class="fl">0.62</span>, <span class="at">Short_Term_Debt =</span> <span class="fl">0.06</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  returns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">US_Equities =</span> <span class="fl">0.07</span>, <span class="at">International_Equities =</span> <span class="fl">0.06</span>, <span class="at">Bonds =</span> <span class="fl">0.04</span>, <span class="at">Short_Term_Debt =</span> <span class="fl">0.02</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to compute contributions (same as before)</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  calc_contributions <span class="ot">&lt;-</span> <span class="cf">function</span>(salary, years) {</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    contributions <span class="ot">&lt;-</span> <span class="fu">numeric</span>(years)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">45000</span>) {</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.03</span> <span class="sc">*</span> salary</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">55000</span>) {</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.035</span> <span class="sc">*</span> salary</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">75000</span>) {</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.045</span> <span class="sc">*</span> salary</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (salary <span class="sc">&lt;=</span> <span class="dv">100000</span>) {</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.0575</span> <span class="sc">*</span> salary</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        employee_contrib <span class="ot">&lt;-</span> <span class="fl">0.06</span> <span class="sc">*</span> salary</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (year <span class="sc">&lt;=</span> <span class="dv">7</span>) {</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>        employer_contrib <span class="ot">&lt;-</span> <span class="fl">0.08</span> <span class="sc">*</span> salary</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        employer_contrib <span class="ot">&lt;-</span> <span class="fl">0.10</span> <span class="sc">*</span> salary</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>      total_contrib <span class="ot">&lt;-</span> employee_contrib <span class="sc">+</span> employer_contrib</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      contributions[year] <span class="ot">&lt;-</span> total_contrib</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>      salary <span class="ot">&lt;-</span> salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> salary_increase_rate)  <span class="co"># Salary increases yearly</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(contributions)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monte Carlo Simulation</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  simulation_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_simulations)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate the contribution and returns for each simulation</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    contributions <span class="ot">&lt;-</span> <span class="fu">calc_contributions</span>(initial_salary, years_at_cuny)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate returns as random variables (e.g., normal distribution with mean returns and standard deviation)</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    total_savings <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    current_age <span class="ot">&lt;-</span> starting_age</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years_at_cuny) {</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine the asset allocation based on age</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">75</span>) {</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>        allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_75_plus</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">60</span>) {</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>        allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_60_74</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (current_age <span class="sc">&gt;=</span> <span class="dv">50</span>) {</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>        allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_50_59</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>        allocation <span class="ot">&lt;-</span> asset_allocation<span class="sc">$</span>age_25_49</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Simulate the growth rate by drawing random values for returns based on a normal distribution</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>      simulated_growth_rate <span class="ot">&lt;-</span> <span class="fu">sum</span>(allocation <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(returns), <span class="at">mean =</span> returns, <span class="at">sd =</span> <span class="fl">0.02</span>))  <span class="co"># Small standard deviation for randomness</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>      total_savings <span class="ot">&lt;-</span> total_savings <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> simulated_growth_rate) <span class="sc">+</span> contributions[year]</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Increase the age by 1 year</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>      current_age <span class="ot">&lt;-</span> current_age <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the result of this simulation</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    simulation_results[sim] <span class="ot">&lt;-</span> total_savings</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return simulation results (mean, standard deviation, and percentiles)</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(simulation_results),</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(simulation_results),</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(simulation_results),</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(simulation_results),</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">p10 =</span> <span class="fu">quantile</span>(simulation_results, <span class="fl">0.10</span>),</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">p90 =</span> <span class="fu">quantile</span>(simulation_results, <span class="fl">0.90</span>)</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Usage of Monte Carlo Simulation</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>initial_salary <span class="ot">&lt;-</span> <span class="dv">65000</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>salary_increase_rate <span class="ot">&lt;-</span> <span class="fl">0.03</span>  <span class="co"># 3% annual increase in salary</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>years_at_cuny <span class="ot">&lt;-</span> <span class="dv">20</span>           <span class="co"># Employee works 20 years at CUNY</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>starting_age <span class="ot">&lt;-</span> <span class="dv">25</span>            <span class="co"># Start at age 25</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Monte Carlo Simulation with 10,000 iterations</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> <span class="fu">monte_carlo_orp_savings</span>(initial_salary, salary_increase_rate, years_at_cuny, starting_age, <span class="at">num_simulations =</span> <span class="dv">200</span>)</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(simulation_results)</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming simulation_results contains summary statistics</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>simulation_results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fl">505804.1</span>,</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fl">19940.14</span>,</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fl">450809.8</span>,</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fl">571327.3</span>,</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">p10 =</span> <span class="fl">482795.2</span>,</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">p90 =</span> <span class="fl">531700.4</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert total results to monthly results by dividing by 240 months</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>simulation_results_monthly <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_results, <span class="cf">function</span>(x) x <span class="sc">/</span> <span class="dv">240</span>)</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list into a data frame for easy viewing</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>simulation_results_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">names</span>(simulation_results_monthly),</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">Monthly_Value =</span> <span class="fu">unlist</span>(simulation_results_monthly)</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>```</p>
</details>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     Statistic Monthly_Value
mean      mean    2107.51708
sd          sd      83.08392
min        min    1878.37417
max        max    2380.53042
p10        p10    2011.64667
p90        p90    2215.41833</code></pre>
</div>
</div>
<p>Regardless of the outcomes and end benefits for both. I have already made a decision based on economic analysis from FRED and ALPHA historical data. Nothing is certain is my conclusion, and since Iâ€™m not looking to be rich but rather just live comfortably enjoying time with family, frugally, I will choose the TRS benefit; the benefit for life. Perhaps on the side saving/investing for my health bills will do good, unless of course healthcare becomes FREE - then in that case I have nothing more to say that WONDERFUL!!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.gifer.com/3cu3.gif" class="img-fluid figure-img"></p>
<figcaption>RETIREMENT HERE I COME</figcaption>
</figure>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/<Malexandra-Jerez>\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>